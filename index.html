<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AKX MiniApp Earn</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f9f9f9; }
    header { background: #0088cc; color: white; text-align: center; padding: 1rem; font-size: 1.5rem; }
    .section { padding: 1.5rem; display: none; }
    .active { display: block; }
    nav { position: fixed; bottom: 0; width: 100%; display: flex; background: #fff; border-top: 1px solid #ccc; }
    nav button { flex: 1; padding: 1rem; border: none; background: none; font-size: 1rem; }
    nav button:hover { background: #f0f0f0; cursor: pointer; }
    .balance { font-size: 1.2rem; margin: 1rem 0; }
  </style>
</head>
<body>
  <header>AKX EARN BOT MiniApp</header>

  <!-- Home Section -->
  <div id="home" class="section active">
    <h2>Welcome</h2>
    <p class="balance">Balance: $<span id="balance">0.00</span></p>
    <p id="userInfo">Telegram User: (Loading...)</p>
  </div>

  <!-- Task Section -->
  <div id="tasks" class="section">
    <h2>Daily Tasks</h2>
    <p>You can watch up to <b>50 ads daily</b>. Each ad gives <b>$0.005</b>.</p>
    <button onclick="startTask()">Start Task</button>
    <iframe id="adFrame" style="display:none; width:100%; height:400px; border:none;"></iframe>
  </div>

  <!-- Withdraw Section -->
  <div id="withdraw" class="section">
    <h2>Withdraw</h2>
    <form onsubmit="sendWithdraw(event)">
      <label>Number:</label><br>
      <input type="text" id="number" maxlength="11" required><br><br>
      <label>Amount ($):</label><br>
      <input type="number" id="amount" min="0.50" step="0.01" required><br><br>
      <button type="submit">Request Withdraw</button>
    </form>
  </div>

  <nav>
    <button onclick="showSection('home')">Home</button>
    <button onclick="showSection('tasks')">Tasks</button>
    <button onclick="showSection('withdraw')">Withdraw</button>
  </nav>

  <script>
    let balance = 0;
    let adsViewed = 0;

    function showSection(id) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    function startTask() {
      if (adsViewed >= 50) {
        alert('You have reached the daily ad limit!');
        return;
      }
      let frame = document.getElementById('adFrame');
      frame.src = "ads.html";
      frame.style.display = "block";
      setTimeout(() => {
        balance += 0.005;
        adsViewed++;
        document.getElementById('balance').innerText = balance.toFixed(3);
        frame.style.display = "none";
        alert('Ad viewed! Balance updated.');
      }, 5000);
    }

    function sendWithdraw(event) {
      event.preventDefault();
      let number = document.getElementById('number').value;
      let amount = parseFloat(document.getElementById('amount').value);
      if (number.length !== 11) {
        alert('Phone number must be 11 digits!');
        return;
      }
      if (amount < 0.01 || amount > balance) {
        alert('Invalid amount.');
        return;
      }
      let msg = `ðŸ“¤ Withdraw Request\nNumber: ${number}\nAmount: $${amount.toFixed(2)}`;
      if (window.Telegram && Telegram.WebApp) {
        Telegram.WebApp.sendData(msg);
        alert('Withdraw request sent!');
      } else {
        alert('Please open in Telegram Mini App.');
      }
    }
  </script>
</body>
</html>
